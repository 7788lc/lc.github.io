[{"url":"/2021/09/22/7.1/","content":"\n**参数估计和假设检验**\n\n区间估计\n\n7.1 有一大批糖果，从中随机抽取16袋，称得质量（单位：g）如下：\n\n506 508 499 503 504 510 497 512\n\n514 505 493 496 506 502 509 496\n\n设袋装糖果质量近似服从正态分布，试求总体均值$\\;\\mu$的置信度为0.95的置信区间。\n\n假设与条件:\n\n1.糖果质量近似服从正态分布。\n\n2.随机取16袋样本，置信度为0.95，构造估计量的样本数小于30，根据经验为小样本,并且总体方差未知。\n\n要用t分布建立总体均值$\\;\\mu$的置信区间\n\n解：总体均值$\\;\\mu\\;$在1-$\\;\\alpha\\;$置信水平下的置信区间为$\\;\\big(\\overline{X} \\pm \\frac{S}{\\sqrt{n}}t_{\\alpha/2}(n-1)\\big) $\n\n$\\overline{X}$--样本均值，S为样本标准差，n为样本容量。\n\n显著水平$\\alpha$=0.05,$\\alpha/2$=0.025,自由度n-1=15，查t分布表得$t_{\\alpha/2}(n-1)$=2.1315\n\n\n\n\n\n\n\n```python\nimport numpy as np\nfrom scipy import stats\nimport matplotlib.pyplot as plt\nx = [506 ,508 ,499 ,503 ,504 ,510 ,497 \n     ,512 ,514 ,505 ,493 ,496 ,506 ,502 ,509 ,496]\n\n#t分布建立置信区间函数\ndef t_interval(x,conf,df):\n    alpha = 1-conf#\n    n = df-1#自由度\n        \n    std = np.std(x,ddof=1)#标准差\n    mu = np.mean(x)#均值\n    t_score = stats.t.isf(alpha/2,df=n)#t分布临界值\n   \n    low = mu-(std/np.sqrt(df))*t_score\n    upper = mu+(std/np.sqrt(df))*t_score\n    \n    return [low,upper]\n\nt_interval(x,0.95,16)\n\n#有95%的样本糖果均值所构造的置信区间会包括总体糖果的质量均值\n#或者说95%把握认为总体糖果质量均值落在置信区间中\n```\n\n\n\n\n    [500.44510746243924, 507.05489253756076]\n\n\n\n\n```python\n#使用scipy 求置信区间\nsem = stats.sem(x)#样本标准误差\nmu = np.mean(x)#均值\nci = stats.t.interval(alpha=0.95,df=len(x)-1,loc=mu,scale=sem)\nci\n```\n\n\n\n\n    (500.44510746243924, 507.05489253756076)\n\n\n\n**例7.3**\n分别使用金球和铂球测定引力常数(单位：10-11m3×kg-1×s-2)．\n\n   (1)用金球测定观测值6.683，6.681，6.676，6.678，6.679,6.672;\n\n   (2)用铂球测定观测值6.661，6.661，6.667，6.667，6.664.设测定值总体为N(u，σ2)，其中u、σ2均未知．试就(1)、(2)两种情况分别求u的置信度为0.9的置信区间，并求σ2的置信度为0.9的置信区间\n\n**1.求u的置信度为0.9的置信区间：**\n\n由于是小样本抽样，并且总体均值与方差未知，使用t分布建立总体均值$\\;\\mu$的置信区间\n\n总体均值$\\;\\mu\\;$在1-$\\;\\alpha\\;$置信水平下的置信区间为$\\;\\big(\\overline{X} \\pm \\frac{S}{\\sqrt{n}}t_{\\alpha/2}(n-1)\\big) $\n\n这里1-$\\;\\alpha\\;$=0.9,$\\;\\alpha\\;$=0.1,$\\;\\alpha/2$=0.05,\n\n金球样本自由度为n1-1=5,铂球样本自由度为n2-1=4\n\n\n\n\n\n\n\n```python\nx1 = [6.683,6.681,6.676,6.678,6.679,6.672]\nx2 = [6.661,6.661,6.667,6.667,6.664]\n#使用之前t_interval函数 建立置信区间\nx1_ci=t_interval(x1,0.9,6)\nx2_ci=t_interval(x2,0.9,5)\nprint('用金球测定时,μ的置信区间是{}'.format(x1_ci))\nprint('用铂球测定时,μ的置信区间是{}'.format(x2_ci))\nprint('###############')\n\n################\n\n#使用scipy库计算#\nx1_sem = stats.sem(x1)\nx2_sem = stats.sem(x2)\n\nx1_df = len(x1)-1\nx2_df=len(x2)-1\n\nx1_mu=np.mean(x1)\nx2_mu=np.mean(x2)\n\nx1_ci=stats.t.interval(alpha=0.9,df=x1_df,loc=x1_mu,scale=x1_sem)\nx2_ci=stats.t.interval(alpha=0.9,df=x2_df,loc=x2_mu,scale=x2_sem)\nprint('用金球测定时,μ的置信区间是{}'.format(x1_ci))\nprint('用铂球测定时,μ的置信区间是{}'.format(x2_ci))\n\n```\n\n    用金球测定时,μ的置信区间是[6.67498413748818, 6.681349195845152]\n    用铂球测定时,μ的置信区间是[6.66113982740759, 6.6668601725924095]\n    ###############\n    用金球测定时,μ的置信区间是(6.67498413748818, 6.681349195845152)\n    用铂球测定时,μ的置信区间是(6.66113982740759, 6.6668601725924095)\n    \n\n**2.求σ2的置信度为0.9的置信区间**\n与第一个问题不同，这是要求方差的置信区间，方差与样本差异有关，而与样本量关系不大。\n\n样本方差服从自由度为n-1的卡方分布（证明要看数理统计教材），所以直接用总体方差的区间估计方法：\n$$\\frac{(n-1)s^2}{\\chi_{\\alpha/2}^2} \\leq \\sigma^2 \\leq \\frac{(n-1)s^2}{\\chi_{1-\\alpha/2}^2} $$\n\n这里$S^2$是样本方差，$\\chi_{\\alpha/2}^2$， $\\chi_{1-\\alpha/2}^2$是卡方分布临界值\n\n\n\n\n\n```python\nx1 = [6.683,6.681,6.676,6.678,6.679,6.672]\nx2 = [6.661,6.661,6.667,6.667,6.664]\ndef chi_interval(x,conf,n):\n    #std = np.std(x1,ddof=1)\n    var  =np.var(x1,ddof=1)#方差\n    alpha = 1-conf\n    df = n-1\n    score_0 = stats.chi2.isf(alpha/2,df)#下界卡方分布临界值\n    score\n```\n\n\n```python\nx1 = [6.683,6.681,6.676,6.678,6.679,6.672]\nx2 = [6.661,6.661,6.667,6.667,6.664]\ndef chi_interval(x,conf,n):\n    #std = np.std(x1,ddof=1)\n    var  =np.var(x,ddof=1)#方差\n    alpha = 1-conf\n    df = n-1\n    score_0 = stats.chi2.isf(alpha/2,df)#下界卡方分布临界值\n    score_1 = stats.chi2.isf(1-alpha/2,df)#上界卡方分布临界值\n    #或者使用stats.chi2.interval(0.9,5)求临界值\n    #score=stats.chi2.interval(conf,df)\n   # print(score)(1.145476226061769, 11.070497693516351)\n    #score_0=score[1]\n    #score_1=score[0]\n    \n    \n\n    low = df*var/score_0\n    upper = df*var/score_1\n    return [low,upper]\n\nx1_ci = chi_interval(x1,0.9,6)\nx2_ci = chi_interval(x2,0.9,5)\nprint('用金球测定时,σ2的置信区间是{}'.format(x1_ci))\nprint('用铂球测定时,σ2的置信区间是{}'.format(x2_ci))\n```\n\n    用金球测定时,σ2的置信区间是[6.759708136442946e-06, 6.532945130656948e-05]\n    用铂球测定时,σ2的置信区间是[3.7943748035426858e-06, 5.065264373908214e-05]\n    \n"},{"title":"11","url":"/2021/09/22/11/"}]